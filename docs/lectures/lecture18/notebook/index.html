<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" integrity="sha384-WskhaSGFgHYWDcbwN70/dfYBj47jz9qbsMId/iRN3ewGhXQFZCSftd1LZCfmhktB" crossorigin="anonymous">

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">

    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed|Roboto:300,400,700" rel="stylesheet">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.0/normalize.min.css">

    <link rel="stylesheet" href="../../../style/tipuesearch/tipuesearch.css">

    <link rel='shortcut icon' type='image/x-icon' href='../../../style/images/favicon.ico' />
    <link rel="stylesheet" href="../../../style/css/hiacs.css">

    <title>CS109B - Lecture 18 Notebook</title>

    <style>
      .navbar {
        background-color: #A51C30
      }
    </style>
  </head>
  <body>

<nav class="navbar navbar-dark navbar-expand-md">
  <div class="container">
    <a class="navbar-brand" href="../../..">
      <img class="navbar-brand-logo" src="../../../style/images/logo.png" />
      <h3 class="course-title">CS109B</h3>
    </a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarsDefault" aria-controls="navbarsDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsDefault">
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/syllabus.html">Syllabus</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/schedule.html">Schedule</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/materials.html">Materials</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/modules.html">Modules</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../../../pages/github.html">GitHub</a>
        </li>
        <form
          class="form-inline my-2"
          action="../../../search.html"
          onsubmit="return validateForm(this.elements['q'].value);"
        >
          <div class="input-group input-group-sm">
            <input class="form-control" type="text" name="q" placeholder="Search Topic">
            <div class="input-group-append">
              <button class="btn btn-default" type="submit">
                <i class="fas fa-search"></i>
              </button>
            </div>
        </div>
      </form>
      </ul>
    </div><!-- .collapse navbar-collapse -->
  </div><!-- .container -->
</nav>
    <main id="content" class="container">
    <div>
      <div class="float-left">
        <p>Key Word(s):
          <a href="../../../pages/materials.html#Autoencoders">Autoencoders</a>        </p>
      </div>
      <div class="float-right">
        <a href="https://github.com/Harvard-IACS/2019-CS109B/blob/master/content/lectures/lecture18/notes/cs109b-lecture18-example.ipynb">
          Download Notebook <i class="fas fa-download"></i>
        </a>
      </div>
    </div>
    <br />
    <hr />
  <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI colors. */
.ansibold {
  font-weight: bold;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  border-left-width: 1px;
  padding-left: 5px;
  background: linear-gradient(to right, transparent -40px, transparent 1px, transparent 1px, transparent 100%);
}
div.cell.jupyter-soft-selected {
  border-left-color: #90CAF9;
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected {
  border-color: #ababab;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 5px, transparent 5px, transparent 100%);
}
@media print {
  div.cell.selected {
    border-color: transparent;
  }
}
div.cell.selected.jupyter-soft-selected {
  border-left-width: 0;
  padding-left: 6px;
  background: linear-gradient(to right, #42A5F5 -40px, #42A5F5 7px, #E3F2FD 7px, #E3F2FD 100%);
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
  border-left-width: 0px;
  padding-left: 6px;
  background: linear-gradient(to right, #66BB6A -40px, #66BB6A 5px, transparent 5px, transparent 100%);
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  padding: 0.4em;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. We need the 0 value because of how we size */
  /* .CodeMirror-lines */
  padding: 0;
  border: 0;
  border-radius: 0;
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}


.rendered_html pre,



.rendered_html tr,
.rendered_html th,

.rendered_html td,


.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,

div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style>
<style type="text/css">
/* Temporary definitions which will become obsolete with Notebook release 5.0 */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-bold { font-weight: bold; }
</style>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div>
<div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1><img src="https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/iacs.png" style="float: left; padding-right: 10px; width: 45px"> CS109B Data Science 2: Advanced Topics in Data Science</h1>
<h2 id="Lecture-18:-Autoencoders-Example">Lecture 18: Autoencoders Example<a class="anchor-link" href="#Lecture-18:-Autoencoders-Example">¶</a></h2><p><strong>Harvard University</strong><br>
<strong>Spring 2019</strong><br>
<strong>Instructors:</strong> Pavlos Protopapas and Mark Glickman<br></p>
<hr style="height:2pt">
<p>Code and ideas taken/borrowed/adapted from 
Deep Learning From Basics to Practice, by Andrew Glassner, <a href="https://dlbasics.com">https://dlbasics.com</a>, <a href="http://glassner.com">http://glassner.com</a>, Python utilities for saving and loading files, mostly images and Keras model weights</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1">#RUN THIS CELL </span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="k">import</span> <span class="n">HTML</span>
<span class="n">styles</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/Harvard-IACS/2018-CS109A/master/content/styles/cs109.css"</span><span class="p">)</span><span class="o">.</span><span class="n">text</span>
<span class="n">HTML</span><span class="p">(</span><span class="n">styles</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt output_prompt">Out[1]:</div>
<div class="output_html rendered_html output_subarea output_execute_result">
<style>
blockquote { background: #AEDE94; }
h1 { 
    padding-top: 25px;
    padding-bottom: 25px;
    text-align: left; 
    padding-left: 10px;
    background-color: #DDDDDD; 
    color: black;
}
h2 { 
    padding-top: 10px;
    padding-bottom: 10px;
    text-align: left; 
    padding-left: 5px;
    background-color: #EEEEEE; 
    color: black;
}

div.exercise {
	background-color: #ffcccc;
	border-color: #E9967A; 	
	border-left: 5px solid #800080; 
	padding: 0.5em;
}

span.sub-q {
	font-weight: bold;
}
div.theme {
	background-color: #DDDDDD;
	border-color: #E9967A; 	
	border-left: 5px solid #800080; 
	padding: 0.5em;
	font-size: 18pt;
}
div.gc { 
	background-color: #AEDE94;
	border-color: #E9967A; 	 
	border-left: 5px solid #800080; 
	padding: 0.5em;
	font-size: 12pt;
}
p.q1 { 
    padding-top: 5px;
    padding-bottom: 5px;
    text-align: left; 
    padding-left: 5px;
    background-color: #EEEEEE; 
    color: black;
}
header {
   padding-top: 35px;
    padding-bottom: 35px;
    text-align: left; 
    padding-left: 10px;
    background-color: #DDDDDD; 
    color: black;
}
</style>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">keras.datasets</span> <span class="k">import</span> <span class="n">mnist</span>
<span class="kn">from</span> <span class="nn">keras.models</span> <span class="k">import</span> <span class="n">Sequential</span><span class="p">,</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Dense</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1">#import h5py</span>
<span class="c1">#from pathlib import Path</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">keras</span> <span class="k">import</span> <span class="n">backend</span> <span class="k">as</span> <span class="n">keras_backend</span>
<span class="n">keras_backend</span><span class="o">.</span><span class="n">set_image_data_format</span><span class="p">(</span><span class="s1">'channels_last'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stderr output_text">
<pre>Using TensorFlow backend.
/Users/pavlos/anaconda3/lib/python3.6/importlib/_bootstrap.py:219: RuntimeWarning: compiletime version 3.5 of module 'tensorflow.python.framework.fast_tensor_util' does not match runtime version 3.6
  return f(*args, **kwds)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># I will be saving everything so I can re-use them </span>
<span class="n">save_files</span> <span class="o">=</span> <span class="kc">True</span>

<span class="kn">import</span> <span class="nn">os</span><span class="o">,</span> <span class="nn">sys</span><span class="o">,</span> <span class="nn">inspect</span>
<span class="n">current_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">getfile</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">currentframe</span><span class="p">())))</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">current_dir</span><span class="p">))</span> <span class="c1"># path to parent dir</span>
<span class="kn">from</span> <span class="nn">DLBasics_Utilities</span> <span class="k">import</span> <span class="n">File_Helper</span>
<span class="n">file_helper</span> <span class="o">=</span> <span class="n">File_Helper</span><span class="p">(</span><span class="n">save_files</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">random_seed</span> <span class="o">=</span> <span class="mi">52</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>

<span class="c1"># Read MNIST data. Of course we will not be using y_train and y_test</span>
<span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">),</span> <span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span> <span class="o">=</span> <span class="n">mnist</span><span class="o">.</span><span class="n">load_data</span><span class="p">()</span>

<span class="c1"># Full size of the image 28x28 </span>
<span class="n">N_pixels</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

<span class="c1"># Convert to floats</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">keras_backend</span><span class="o">.</span><span class="n">cast_to_floatx</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">keras_backend</span><span class="o">.</span><span class="n">cast_to_floatx</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Normalize the range from [0,255] to [0,1]</span>
<span class="n">X_train</span> <span class="o">/=</span> <span class="mf">255.</span>
<span class="n">X_test</span> <span class="o">/=</span> <span class="mf">255.</span>

<span class="c1"># Reshape the data into a grid with one row per sample, each row 784 (28*28) pixels</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">X_train</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_train</span><span class="p">),</span> <span class="n">N_pixels</span><span class="p">))</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">X_test</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">X_test</span><span class="p">),</span> <span class="n">N_pixels</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"X_train.shape = "</span><span class="p">,</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s2">" X_test.shape = "</span><span class="p">,</span><span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>X_train.shape =  (60000, 784)  X_test.shape =  (10000, 784)
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">draw_predictions_set</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="n">filename</span><span class="o">+</span><span class="s1">'-predictions'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [28]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Build and train our first autoencoder</span>
<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">modelAE1</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">))</span>
<span class="n">modelAE1</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'mse'</span><span class="p">)</span>


<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"modelAE1-weights"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">modelAE1</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">modelAE1</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">modelAE1</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [29]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predictions1</span> <span class="o">=</span> <span class="n">modelAE1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">draw_predictions_set</span><span class="p">(</span><span class="n">predictions1</span><span class="p">,</span> <span class="s1">'FCC1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [30]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># Build and train our first autoencoder</span>
<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">modelAE1_s</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">()</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">))</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="n">N_pixels</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">))</span>
<span class="n">modelAE1_s</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">)</span>


<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"modelAE1-weights-sigmoid"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">modelAE1_s</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
                   <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                   <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                   <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">modelAE1_s</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">predictions1</span> <span class="o">=</span> <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">draw_predictions_set</span><span class="p">(</span><span class="n">predictions1</span><span class="p">,</span> <span class="s1">'FCC1-s'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAAD3CAYAAAAQVC6+AAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAIABJREFUeJzt3XmQVcXZx/FnFEVxQURQQYIsgoCi
gmvcdyKCiqIWlDGaSDYrVmnUGM2mMVZpRbMZrSRlRY1ljHEJiBKNQYmlaNxQZBMUUIEIiohb3Ob9
J+n310/mtGfu3Htnbs/389dzqw9nztxzz52mn366m5qbmw0AACAnG7T3BQAAAFQbHRwAAJAdOjgA
ACA7dHAAAEB26OAAAIDs0MEBAADZoYMDAACyQwcHAABkhw4OAADITpfWHNzU1MSyx+2oubm5qa3n
4B62L+5h4+MeNj7uYeMrcw8ZwQEAANmhgwMAALJDBwcAAGSHDg4AAMgOHRwAAJAdOjgAACA7dHAA
AEB26OAAAIDstGqhP6Bavv3tb0evN9100xCPHDkyajvppJNaPMd1110XvX7sscdCfPPNN7f1EgEA
DYwRHAAAkB06OAAAIDt0cAAAQHaampvL7xfG5mLtq9E3iLvttttCXDSvpi2WLFkS4iOOOCJqW758
edV/XiUa/R7W2pAhQ0K8YMGCqO2cc84J8S9/+cu6XZPXWe7hZpttFr2+6qqrQvzVr341xE899VR0
3MSJE0O8bNmyGl1d23SWe5gzNtsEAACdEh0cAACQHcrEUTOakjIrn5byqYm//vWvIR44cGCIx40b
Fx03aNCgEE+ePDlqu+KKK0r9bLSvPfbYI8Sffvpp1Pbqq6/W+3I6te233z56fdZZZ4VY783o0aOj
44499tgQX3vttTW6OvzXqFGjotd33nlniHfcccea/uyjjjoqej1//vwQv/LKKzX92WUwggMAALJD
BwcAAGSHDg4AAMgOc3BQVXvuuWeITzjhhMLjXnjhhej1+PHjQ7xmzZqo7Z133gnxxhtvHOLZs2dH
x+22224h7tmzZ8krRkey++67h/jdd9+N2u666656X06n06tXrxDfeOON7XglKOvoo4+OXnft2rVu
P9vPgzzzzDNDfOqpp9btOoowggMAALJDBwcAAGSn3VNUWjqsZYgrVqyIjvvggw9CfMstt0Rtq1at
CvHixYurfYloBS0tbWqKF5rUtJQfVl25cmWp85933nkhHj58eOFx06dPL3U+tK9ddtklen322WeH
mB3ha+9b3/pW9Pr4448P8d57713ROQ866KAQb7BB/H/oOXPmhHjWrFkVnR9mXbr8/5/uY445pt2u
w69ife6554ZYV8L26eZ6YQQHAABkhw4OAADITrunqK688soQl111UTd6MzNbv359iH11Tq3p6qr6
uzz55JN1vY6OYtq0aSEePHhw1Kb36c0336zo/Dozf6ONNqroHOg4dt555+i1Dmv7lbBRfddcc030
2q8eXYkJEya0GJvFm2+ecsopUZtPd6DYoYceGuL99tsvatO/Q7XWo0eP6LVOG+jWrVuISVEBAABU
CR0cAACQHTo4AAAgO+0+B0dLw0eOHBli3ZXUzGzYsGEh9runHnLIISHed999ozbd0bRfv36lrunj
jz+OXq9evTrEfoddtXz58hB31jk4SvPtbXH++eeHeMiQIYXHPf744y3G6LguuOCC6LV+ZniGauPe
e+8NsS/jrsQbb7wRvdaVx/v37x+1DRgwIMRPPPFE1Lbhhhu2+Vpy5ZdTuPXWW0O8ZMmSqO0nP/lJ
Xa7JzOy4446r28+qBCM4AAAgO3RwAABAdto9RfXggw+2GHszZswobNNSNd2szywuPdxrr71KXZOu
mmxmtmjRohD71NnWW28dYj9UiMoce+yx0etLL700xLrZ5uuvvx4dd9FFF4X4vffeq9HVoa10OQjd
nNUsftbaq7Q0NwcffHD0eujQoSH2ZeFly8Svv/76EN9///1R27p160J82GGHRW0XX3xx4Tm//vWv
h/i6664rdR2dxSWXXBK91uUUxowZE7VpirAW9G+e/2xVY5mBamIEBwAAZIcODgAAyA4dHAAAkJ12
n4NTDWvXrg3xzJkzC49LzfFJOfHEE0Psl6Z+/vnnQ8zS8tXh52XovBvl3++HH364ZteE6vF5e6VL
MqByOs/pj3/8Y9S2zTbblDqHX+bhjjvuCPGPfvSjEKfmu/lzTJkyJcS9evWK2nSLgU022STEv/rV
r6LjPvroo9RlZ+Okk04Ksd8xfPHixSGu93IKOo/Kz7l56KGHQvzWW2/V65IKMYIDAACyQwcHAABk
J4sUVbX17t07ev3rX/86xH7lTy1hrnSHbJjdfffdIT7qqKMKj7vppptC7Esn0Rh23XXXwrZ67oSc
sy5d/v+rvWxKyixO85566qlR25o1a1p9HT5FdcUVV4T46quvjtp092n9HEydOjU6rrMsxzFx4sQQ
63tjFv9NqjVNd5qZTZ48OcSffPJJ1PbjH/84xB0hlcgIDgAAyA4dHAAAkB06OAAAIDvMwWnBN7/5
zei1ljNqSbqZ2cKFC+tyTbnxu7J//vOfD3HXrl2jNs39a4631kuSo3r23XffEJ9xxhkhfuaZZ6Lj
HnjggbpdE/63xPjMM88McSVzbj6LzqfRuRxm5bfSyVn37t1DrM+MV8+tLLS03yye0+W3Lkot09Ie
GMEBAADZoYMDAACyQ4rqP/bff/8Qf+c73yk87vjjj49ez507t2bXlDNdFdXMrGfPnoXH/uEPfwhx
ZykRzc0RRxwRYt2NeMaMGdFxH3zwQd2uqbPwS1uoffbZp45XYtbU1BRif11F1/nDH/4wen3aaadV
/bo6Ck3P9+3bN8S33npre1yOmZkNGjSosK2j//1jBAcAAGSHDg4AAMgOKar/0M3MNtpoo6hNN+l8
7LHH6nZNuRk/fnyIR40aVXicbthmZvaDH/ygVpeEOtltt91C3NzcHOI///nP7XE52fva174WYr8h
YnsaN25ciPfYY4+oTa9TY5+iytn69etD/Oyzz4Z45MiR0XGa5q3FCvq6mr9u+uk98sgjVf/Z1cQI
DgAAyA4dHAAAkB06OAAAIDuddg7OpptuGr0eM2ZMiD/88MOoTeeAdIQdUhuFL/3+7ne/G2I/z0lp
7tmMFYsb0XbbbRe9PvDAA0Osq3/fdddddbumzkTnutSbrvw+fPjwqE2/A1JWr14d4s70nfv++++H
WJfEOPHEE6Pjpk+fHmK/K3tZu+yyS4gHDhwYtekO4jpnzutI87tawggOAADIDh0cAACQnU6bojr/
/POj11qy6FdXffTRR+tyTbk577zzotepzfTuvvvuEFMW3vi+9KUvRa+17PS+++6r89Wgni6++OIQ
+42LU5YuXRri008/PcTLly+vynU1Gv0e1BWgzczGjh0b4kpXOdbNVH0aSjfUTPn9739f0c+uF0Zw
AABAdujgAACA7NDBAQAA2elUc3A0b/m9730vanv77bdDfOmll9btmnJ27rnnlj727LPPDjFl4Y2v
f//+hW1r166t45Wg1u69997o9dChQys6z7x580Lc0bcAqIcFCxaE+OSTT47adt999xAPHjy4ovOn
tkm58cYbQzx58uTC47SsvSNiBAcAAGSHDg4AAMhO9ikqXU33F7/4RYg33HDD6DgdZp09e3btLwwR
3R230pVL161bV3gOXTm5e/fuhefYaqutQtyaFNsnn3wS4gsvvDBqe++990qfJxfHHntsYdu0adPq
eCWdk5YVb7BB8f9jv/CFLxS2/eY3v4le9+nTp8Xj/PkrXd22PVdfbjS62rtf+b0aXnrppVLH6WrI
ZmZz586t+rW0BSM4AAAgO3RwAABAdujgAACA7GQ3B8fPrdFtFwYMGBBi3anV7H/LxlFfzz33XJvP
cfvtt4d45cqVUdu2224b4lNOOaXNPytl1apV0evLL7+8pj+vozjggANC7HcTR31dd911Ib7yyisL
j7vnnnui16n5M2Xn1pQ97vrrry91HOpP53D5bSJUR5tz4zGCAwAAskMHBwAAZCe7FNWgQYOi16NH
j27xOF8C7FNWaDu/wulxxx1X0583ceLEiv7dxx9/HOLU8PrUqVND/OSTTxYe949//KOi62h0J5xw
Qoh9qviZZ54J8axZs+p2TZ3VnXfeGeLzzz8/auvVq1dNf/bq1atDPH/+/KhtypQpIfZpZHQcuru4
32m8kTCCAwAAskMHBwAAZCeLFJVu7Hf//fcXHqdDtb56ANU3YcKE6PUFF1wQYl1Z+LOMGDEixGUr
oG644Ybo9dKlSwuPveOOO0KsG9whrVu3btHrY445pvBY3dhPV31GbSxbtizEp556atR2/PHHh/ic
c86p+s/WqsFrr7226udH7W2yySaFbR19g03FCA4AAMgOHRwAAJAdOjgAACA7Ta0pAWtqauqQ9WKa
873ooosKj9t7771DnCrz7aiam5uLl5QsqaPew84ip3vo51E9/PDDIX799dejtkmTJoW40XdXz+ke
jhkzJnqtZdx+d29dJkF3Gvcr3c6bNy/Ey5cvr8p1VltO97AWdDX2Ll3iqbqXXXZZiH/+85/X7Zq8
MveQERwAAJAdOjgAACA7DZmi0k39zOIVczfffPPCf0eKquPcw86Ke9j4uIeNj3uYNm3atBBfffXV
UdvMmTPrfTktIkUFAAA6JTo4AAAgO3RwAABAdhpyq4YDDzwwep2ad6O7hL/zzjs1uyYAAHLglwho
VIzgAACA7NDBAQAA2WnIFFXKnDlzoteHH354iN988816Xw4AAGgHjOAAAIDs0MEBAADZoYMDAACy
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
">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [31]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>

<span class="n">filepath</span> <span class="o">=</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">get_input_file_path</span><span class="p">(</span><span class="s2">"pavlos-gray-28-28.png"</span><span class="p">)</span>
<span class="n">im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span> 
<span class="n">pix</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
<span class="n">pavlos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">784</span><span class="p">))</span>
<span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">28</span><span class="p">):</span>
        <span class="n">pavlos</span><span class="p">[</span><span class="mi">0</span><span class="p">,(</span><span class="n">y</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span><span class="o">+</span><span class="n">x</span><span class="p">]</span> <span class="o">=</span> <span class="n">pix</span><span class="p">[</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">255.</span>
        
<span class="n">predicted_pavlos</span> <span class="o">=</span> <span class="n">modelAE1_s</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">pavlos</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">pavlos</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">predicted_pavlos</span><span class="p">,</span> <span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">)),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="s1">'Model-FCC-pavlos-pair'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [33]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># rebuild model with the Functional API so we can play with the decoder alone</span>
<span class="kn">from</span> <span class="nn">keras.layers</span> <span class="k">import</span> <span class="n">Input</span>

<span class="n">num_latent_vars</span> <span class="o">=</span> <span class="mi">20</span>

<span class="n">model_encoder_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">784</span><span class="p">,))</span>
<span class="n">model_encoder_512</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_encoder_256</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_encoder_latent</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>

<span class="n">model_decoder_256</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_decoder_512</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'relu'</span><span class="p">)</span>
<span class="n">model_decoder_out</span> <span class="o">=</span> <span class="n">Dense</span><span class="p">(</span><span class="mi">784</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'sigmoid'</span><span class="p">)</span>

<span class="n">model_encoder_step_1</span> <span class="o">=</span> <span class="n">model_encoder_512</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">)</span>
<span class="n">model_encoder_step_2</span> <span class="o">=</span> <span class="n">model_encoder_256</span><span class="p">(</span><span class="n">model_encoder_step_1</span><span class="p">)</span>
<span class="n">model_encoder_output</span> <span class="o">=</span> <span class="n">model_encoder_latent</span><span class="p">(</span><span class="n">model_encoder_step_2</span><span class="p">)</span>

<span class="n">model_decoder_step_1</span> <span class="o">=</span> <span class="n">model_decoder_256</span><span class="p">(</span><span class="n">model_encoder_output</span><span class="p">)</span>
<span class="n">model_decoder_step_2</span> <span class="o">=</span> <span class="n">model_decoder_512</span><span class="p">(</span><span class="n">model_decoder_step_1</span><span class="p">)</span>
<span class="n">model_decoder_output</span> <span class="o">=</span> <span class="n">model_decoder_out</span><span class="p">(</span><span class="n">model_decoder_step_2</span><span class="p">)</span>

<span class="n">model_AE_F</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">,</span> <span class="n">model_decoder_output</span><span class="p">)</span>

<span class="n">model_encoder_only_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_encoder_input</span><span class="p">,</span> <span class="n">model_encoder_output</span><span class="p">)</span>

<span class="n">model_decoder_only_input</span> <span class="o">=</span> <span class="n">Input</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">num_latent_vars</span><span class="p">,))</span>
<span class="n">model_decoder_only_step_1</span> <span class="o">=</span> <span class="n">model_decoder_256</span><span class="p">(</span><span class="n">model_decoder_only_input</span><span class="p">)</span>
<span class="n">model_decoder_only_step_2</span> <span class="o">=</span> <span class="n">model_decoder_512</span><span class="p">(</span><span class="n">model_decoder_only_step_1</span><span class="p">)</span>
<span class="n">model_decoder_only_output</span> <span class="o">=</span> <span class="n">model_decoder_out</span><span class="p">(</span><span class="n">model_decoder_only_step_2</span><span class="p">)</span>
<span class="n">model_decoder_only_model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">model_decoder_only_input</span><span class="p">,</span> <span class="n">model_decoder_only_output</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [36]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="n">model_AE_F</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">optimizer</span><span class="o">=</span><span class="s1">'adadelta'</span><span class="p">,</span> <span class="n">loss</span><span class="o">=</span><span class="s1">'binary_crossentropy'</span><span class="p">)</span>

<span class="n">weights_filename</span> <span class="o">=</span> <span class="s2">"model-AE-F-weights"</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">52</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">file_helper</span><span class="o">.</span><span class="n">load_model_weights</span><span class="p">(</span><span class="n">model_AE_F</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">):</span>
    <span class="n">model_AE_F</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span>
               <span class="n">epochs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
               <span class="n">verbose</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
               <span class="n">validation_data</span><span class="o">=</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">X_test</span><span class="p">))</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_model_weights</span><span class="p">(</span><span class="n">model_AE_F</span><span class="p">,</span> <span class="n">weights_filename</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Train on 60000 samples, validate on 10000 samples
Epoch 1/20
 - 15s - loss: 0.1196 - val_loss: 0.1163
Epoch 2/20
 - 17s - loss: 0.1169 - val_loss: 0.1133
Epoch 3/20
 - 15s - loss: 0.1146 - val_loss: 0.1117
Epoch 4/20
 - 17s - loss: 0.1125 - val_loss: 0.1092
Epoch 5/20
 - 15s - loss: 0.1108 - val_loss: 0.1116
Epoch 6/20
 - 15s - loss: 0.1094 - val_loss: 0.1069
Epoch 7/20
 - 16s - loss: 0.1080 - val_loss: 0.1068
Epoch 8/20
 - 16s - loss: 0.1069 - val_loss: 0.1043
Epoch 9/20
 - 18s - loss: 0.1058 - val_loss: 0.1044
Epoch 10/20
 - 17s - loss: 0.1049 - val_loss: 0.1040
Epoch 11/20
 - 15s - loss: 0.1040 - val_loss: 0.1036
Epoch 12/20
 - 17s - loss: 0.1032 - val_loss: 0.1029
Epoch 13/20
 - 17s - loss: 0.1025 - val_loss: 0.1017
Epoch 14/20
 - 16s - loss: 0.1018 - val_loss: 0.1007
Epoch 15/20
 - 16s - loss: 0.1012 - val_loss: 0.1001
Epoch 16/20
 - 16s - loss: 0.1005 - val_loss: 0.0996
Epoch 17/20
 - 19s - loss: 0.1000 - val_loss: 0.0983
Epoch 18/20
 - 17s - loss: 0.0995 - val_loss: 0.0981
Epoch 19/20
 - 17s - loss: 0.0990 - val_loss: 0.0982
Epoch 20/20
 - 16s - loss: 0.0985 - val_loss: 0.0978
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [37]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># show the input data, its latent values, and the corresponding predicted images</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">encoder_predictions</span> <span class="o">=</span> <span class="n">model_encoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">latent_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="n">latent_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">X_test</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">latent_min</span><span class="p">,</span> <span class="n">latent_max</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">11</span><span class="p">)</span>
    <span class="n">decoder_model_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
    <span class="n">decoder_prediction</span> <span class="o">=</span> <span class="n">model_decoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">decoder_model_input</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">decoder_prediction</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="s2">"model-F-latents-and-output"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,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
9Y7j+KTV/z7WzPaI43j4dx43zMyGrf5nZzOb2/TTrWkd4jhuU8ofSA5TRw6zjxxmHznMvqJy2Jyb
jKM8x+qNluI4vsnMbmrG86B8yGH2kcPsI4fZRw6rUHNaVO+ZWXv59w/M7IPmnQ5SRg6zjxxmHznM
PnJYhZozwHnezLaNomirKIrWNrMhZvZAaU4LKSGH2UcOs48cZh85rEJNblHFcbwqiqLhZvaImbUw
s1viOH61ZGeGsiOH2UcOs48cZh85rE5NvskYAACgWrFVAwAACA4DHAAAEBwGOAAAIDgMcAAAQHAY
4AAAgOAwwAEAAMFhgAMAAILDAAcAAASHAQ4AAAgOAxwAABAcBjgAACA4DHAAAEBwGOAAAIDgMMAB
AADBYYADAACCwwAHAAAEhwEOAAAIDgMcAAAQHAY4AAAgOAxwAABAcBjgAACA4DDAAQAAwWGAAwAA
grNmmk8WRVGc5vOFJo7jqNLnQA6bhxxmHznMPnKYfcXkkAoOAAAIDgMcAAAQHAY4AAAgOAxwAABA
cFK9yRgolTXXrHvrfvvttx7HcZw3BgDUFio4AAAgOAxwAABAcGhRIXVRVLd8wTrrrONxz549Pd5l
l1087tKli5mZde3a1Y+tvfbaHmuLatKkSR7ff//9Hk+fPt3jFStW1Ps+ZIu+hxK0JNOhr73Ga621
lseai2+++SZvDJQbFRwAABCcKM2/eli5sXmyvPqmVmratWvn8fHHH+/x/vvv7/GOO+7o8f/93//V
+3laffnyyy89/uKLLzz+4IMPPL7kkks8Tio7X3/9ddHnXypZzmElrLfeeh4ffPDBHu+6665mZnb3
3Xf7sdmzZ3tczupcreYwqdbo9ThkyBCP99hjD4+32GILj6dOnerx7bff7vHbb79tZpWpvNVqDuW5
PS7F61+oqrfGGnU1FK3eleI5WckYAADUJAY4AAAgONxkjFR07NjR4+SmYTOzli1beqw3EecrbRa6
WfHzzz/3uNA6OIcddpjHL774opnVlcjNuOG4Wul6R9tvv73H++67r5mZzZo1y4/NmTMnvROrQclN
xNp+0okB3bp181jbFF999ZXHU6ZM8XjevHlmxo3H5aafpeuvv369r2tbv7FtpCTP6667rh/TFqbe
eL5s2TKPV65c2ajnaSoqOAAAIDgMcAAAQHAy16LSkrWW3latWuWxlsWSmTK0INKnZeqkHG1mtvPO
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
/gAAAABJRU5ErkJggg==
">
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [38]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># show the latent values and the corresponding predicted images</span>
<span class="c1"># this makes big vertical spaces between the </span>
<span class="k">def</span> <span class="nf">show_latents_and_predictions</span><span class="p">(</span><span class="n">predictions</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
    <span class="n">latent_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="n">latent_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])),</span> <span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([],</span> <span class="p">[])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="n">latent_min</span><span class="p">,</span> <span class="n">latent_max</span><span class="p">)</span>

        <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span>
        <span class="n">decoder_model_input</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
        <span class="n">decoder_prediction</span> <span class="o">=</span> <span class="n">model_decoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">decoder_model_input</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">decoder_prediction</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">),</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">"gray"</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_xaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">file_helper</span><span class="o">.</span><span class="n">save_figure</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [39]:</div>
<div class="inner_cell">
<div class="input_area">
<div class="highlight hl-ipython3"><pre><span></span><span class="c1"># add [-noise to all values</span>
<span class="n">encoder_predictions</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">model_encoder_only_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">))</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">random_seed</span><span class="p">)</span>
<span class="n">noise</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">])):</span>
        <span class="n">encoder_predictions</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=-</span><span class="n">noise</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="n">noise</span><span class="p">)</span>
<span class="n">show_latents_and_predictions</span><span class="p">(</span><span class="n">encoder_predictions</span><span class="p">,</span> <span class="s1">'NB2-MLP-AE5-prediction-latent-values-with-noise-1'</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAjgAAAEDCAYAAAA4IH4FAAAABHNCSVQICAgIfAhkiAAAAAlwSFlz
AAALEgAACxIB0t1+/AAAADl0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uIDIuMS4wLCBo
dHRwOi8vbWF0cGxvdGxpYi5vcmcvpW3flQAAGfVJREFUeJzt3X20VVW5x/HfVEFT8YVAIgEPlpEo
lHFSijTS6mLXAmvYsLI3RXrhktZtKNkfNsy0RiNsjLqjRE3743bJERgkkeLbuFmGwA0TMpRI5E0B
U/GlMGrdPzzr4dlwNmfvfdZ+mXN9P2M4eFics/fyPHvt/Zz5zDlXyLJMAAAAKTmg3ScAAABQNAoc
AACQHAocAACQHAocAACQHAocAACQHAocAACQHAocAACQHAocAACQHAocAACQnINa+WRDhgzJurq6
WvmUyVi5cuWOLMuGtvs8yGHjyGHxHt78nMXjjj2y6c9HDuNHDuNXaw5bWuB0dXVpxYoVrXzKZIQQ
NrT7HCRy2B/ksHhdsxdbvOKb/9705yOH8SOH8as1h7SoAABAcihwAABAcihwAABAcihwAABAcihw
AABAcihwAABAclq6TBwA0Fp+Kf3jLVhKj/Lp1NcYBU6LdeoLAQCAlNCiAgAAyaHAAQAAyaFFBQAo
FK14dAJGcAAAQHIocAAAQHLa1qJiCBO14rUCAKgXIzgAACA5FDgAACA5FDgAACA5LBOvEfNAAACI
ByM4AAAgORQ4AAAgObSoAADoYEyRaAwjOAAAIDmM4ABASTASgDJhBAcAACSHAgcAACSnVC0qhmcB
ACiHUhU49aAYAgAgXn22qEIII0MI94YQHgkhrAkhXNJzfHAIYWkI4bGeP49u/unGqWv24oqCqdXI
YfzIYfzI4Svy98N2vic2ihy2Vn9fK7XMwdkt6T+zLDtR0kRJM0MIYyXNlnR3lmUnSLq75+/oTOSw
nzrgDbntOYz5g6lDtD2H6Lem5ZBrq3h9FjhZlm3Nsuz/euLnJT0i6VhJUyX9uOfLfixpWrNOsiya
9QFCDuNHDuNHDuNHDuNS1xycEEKXpFMkLZM0LMuyrdIrSQ8hHFP42aFw5DB+5DB+nZJD5ho2rlNy
iOpqLnBCCIdLmi/p0izLdoYQav2+GZJmSNKoUaMaOUcuwoK0M4coBjmMHzmMX4o5TPFztqZ9cEII
A/RKMv87y7IFPYefCiEM7/n34ZK29fa9WZbNzbKsO8uy7qFDhxZxzmgAOYwfOYwfOSxOu+aEkcN4
1LKKKki6SdIjWZbNcf+0SNIne+JPSlpY/OmhCKnlsIyT8VLLYRmRw/iRw7jU0qKaJOnjkh4OIazq
OXaFpG9KujWEcJGkJySd15xTRAHIYfzIYRO1aHieHLZQntOC80kOI9JngZNl2f2SqjUYzyr2dNAM
5DB+5DB+5DB+5PAVsczXYSdjlFZRF2ksFzsAlEkSN9ss45wMIGZcswCaLYkCBwAAwKPAAQAAyWEO
DoBSKMtcqbL8fwJ9ocABAKCD9KdIpcDdgxYVAADYrxgXBlDgAACA5NCiAhANht8B1IoRHAAAkJzk
R3Bi6xkCAID+S77AqQfFENA42kdoNt6j98V1Vx0tKgAAkBxGcAAASFDZR3cocNCwsl88AIDORYsK
AAAkhxEcAG3FSCCAZmAEBwAAJIcRHCSLkQEAKC8KHAAA0HZF/1JKgdOgohLBxlUAABSPAgdNQ4sI
ANAuTDIGAADJYQSnCRi5AABgX638fKTAAZAkftEAyq3PFlUI4UchhG0hhNXu2OAQwtIQwmM9fx7d
3NNEf5DD+JHD+JU1h12zF9t/sStrDmNVyxycWyRN2evYbEl3Z1l2gqS7e/6OznWLOiyHKb3ptcgt
6rAcom63iBzG7hYllMPU34f7bFFlWfa/IYSuvQ5PlTS5J/6xpPskXV7geaFAMeSQdsL+xZBD7F8z
c5hfP+26dspy/XIdxqXROTjDsizbKklZlm0NIRxT7QtDCDMkzZCkUaNGNfh0aAJyGD9yGL+OzWFZ
ipYCdGwOy67py8SzLJubZVl3lmXdQ4cObfbToQnIYfzIYfzIYfzIYWs1WuA8FUIYLkk9f24r7pTQ
IuQwfuQwfuQwfuSwQzXaolok6ZOSvtnz58LCzqiFSj4Em0QO95bqZLkqksxhJ2jhnBZyGD9y2KFq
WSb+P5IekDQmhLAphHCRXknke0IIj0l6T8/f0aHIYfzIYfzIYfzIYVxqWUX1kSr/dFbB54ImIYfx
a1UOO2FUsxPOoRm4DuPXCTlM9fpoBu5FBQAAkkOBAwAAksO9qFCYlIZOU/p/6Uu7N4kDgGZgBAcA
ACSHAgcAACSHFhUAQFLp9pFC4ihwUBplmlcDpIBrFv1BgYOW4I0KANBKzMEBAADJocABAADJoUVV
ANovxeLn2TmYdAqgWZr9Xk+BAwAACtFJv6BS4ABoSCe9kQHA3ihwAJQOxVn/0b5ELdp5rVHgAOhY
FCIAGsUqKgAAkBxGcAA0HSMxAFqNERwAAJAcChwAAJCcKFtUDHcDAID9ibLAAQC0Fr9YIja0qAAA
QHIYwQEARI8RJuwtuQKHFznaidcfAHSGfrWoQghTQghrQwjrQgizizoptA45jB85jB85jB857DwN
FzghhAMl/ZeksyWNlfSREMLYok4MzUcO40cO40cO40cOO1N/RnBOlbQuy7L1WZa9LGmepKnFnBZa
hBzGjxzGjxzGjxx2oP4UOMdK2uj+vqnnGOJBDuNHDuNHDuNHDjtQyLKssW8M4TxJ/5Zl2fSev39c
0qlZls3a6+tmSJohSaNGjZqwYcOGXh9v78mZTNasFEJYmWVZd8GPWWgO26Go10k9j9Poc5Yph+24
flvxnGXKYav4vHnksHipfK7WmsP+rKLaJGmk+/sISVv2/qIsy+ZKmitJ3d3dVaupmH/YESs0h2XR
Ya9Vchg/chi/KHLYYe9dTdefFtVySSeEEEaHEAZKOl/SomJOCy1CDuNHDuNHDuNHDjtQwyM4WZbt
DiH8h6Q7JB0o6UdZlq0p7MzQdCnksGy/kewthRyWHTmMHznsTP3a6C/Lsl9K+mVB54I2IIfxI4fx
I4fxI4edh3tRAQCA5FDgAACA5FDgAACA5CR3s00A5VT2CecAKjGCAwAAktOxIzj8NgYA5cL7PorU
sQUOgHjxQYVa8VpBs9CiAgAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHA
AQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyaHAAQAAyQlZlrXu
yULYLmlDy54wLcdlWTa03SdBDvuFHMaPHMaPHMavphy2tMABAABoBVpUAAAgORQ4AAAgORQ4AAAg
ORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4
AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAg
ORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgORQ4AAAgOQe18slCCFkrny81WZaF
dp8DOewfchg/chg/chi/WnLICA4AAEgOBQ4AAEgOBQ4AAEgOBQ4AAEhOSycZAyi3EPbMC8wy5lgC
aB5GcAAAQHIocAAAQHJoUaHjDRw4UJL0z3/+044NGDDA4smTJ1v85je/2eJNmzZZ/Ktf/criHTt2
NOM0UQPaUgBahREcAACQnNDK36jYubF/Utx9s9qk06FDh1o8depUSdKVV15px4YNG2bxAQcc0Gu8
YcMGi59++mmLp02bJknavHlzr8/dTCnmsJn86+OQQw6xOB/Ne/nll1t+TuQwfuQwfuxkDAAASokC
BwAAJCfqScYTJ060eNasWRaffvrpFl977bWSpNtuu82Obdu2zeJ//etfzTxF9MG3hg46aM/Lcfz4
8RZ/+MMfliQdddRRdsxPMq7WXvItjSVLllj86le/WlJl2+rvf/97n4+H1vO5+Nvf/tbGM0E9Dj30
UIuPP/54i//4xz9azHsvmo0RHAAAkBwKHAAAkJwoWlSjRo2yeOHChRaPGzfOYr96xq+8uO666yRJ
L774oh179NFHLfZDpv5r/GP4/VcOPPDAfY55tDcad9JJJ1n83HPPWfzUU09Jknbv3m3H/PD2P/7x
D4vXrl1r8Q033GDxrbfeanHeCjvhhBPs2GOPPWYxrRCguoMPPthifw3l0wEk6dRTT7U4bwlLldfw
4MGDJUkvvfRSU84TYAQHAAAkhwIHAAAkp2NbVH6jt1WrVll89NFH9/m9vk2Ut5TWr19vx3wbY9eu
XRb7Nle11T2jR4+WJF144YV2rLu72+I1a9ZYfPXVV1u8ffv2Ps+77B566CGLX/WqV1m8fPlySdLb
3/52O+ZbWA888IDF/mfuW5G+pZW/hvxKLd8emzdvXq/nR/sRZZZfN4sWLbJjb33rWy32ratq8vdj
ac/17ttcaK586kVZ3ssYwQEAAMmhwAEAAMnp2BbVaaedVtfX+3vSbNy40eIJEyZIknbu3GnH/PCc
Xy3lVVuVdfbZZ0uSLr74YjvmN6A788wzLT7nnHMsPvHEE3s9V/TOb7x38803S5LuuusuO3bZZZdZ
fOONN1rsV8X5PPt8jhgxQpL0gQ98wI7dfvvtFr/2ta+12N+vCiib/FqRpAULFkja854qVV5X9Xr9
618vSTrssMPsmF/JimL4z6+8jehXnlZbEZwCRnAAAEByKHAAAEByOrZFdeedd1rsWxB+1ZNvRf3s
Zz+z+JlnnrG4r9niva24kqThw4dbfPjhh1uct5eOOOIIO1ZtmNavxvGPjb75vLzwwguSKu8d9fWv
f93iHTt2WOx/zn7o9cgjj7Q432xs8eLFdmz+/PkWs/FYMfzQ+MCBAyVVXr/18tdZvirOP0dZVoY0
2zHHHGOxb/nm10VvedhbLa2rPF9+9RUtquL5n+/MmTMlVW6C6qdv1CvPc7WNcduNERwAAJAcChwA
AJCcjm1R+Vne3/rWtyz2GwBW28itHn4oNZ/VL1WuhnrXu95l8RlnnCGpcvO/ap5//nmLub9R//nW
0ciRIy329yr73e9+Z7FvS/mNA/MWlb8/Ffkphr+e/ND4e9/7XknSkiVL7Fi11YT+MfzmjvkKRu9r
X/uaxf49A/Xx15DfCNXncNCgQZIqWxD+mvSx/z7fvvAt5JtuuklS5aadKIb/OU+bNs3i/DOuls8v
z+fwkEMOsXjKlCmSKqeL+I15/b3H2oERHAAAkJyOHcHxFaOfXOrjIh77Na95jcV+y/BNmzZZfPLJ
J1uc3xm32l46/q7U+f4t6J/8Z+0nIPqJxflvllLlhPB8YqskjRkzxuJ8lIdRm2L4n7O/Fk4//XSL
f/3rX0uqbQ+oQw891OILLrjA4nPPPdfifJQhvyO1tOeu86iNz9ucOXMsrjb6ko+S++tm6dKlFl9z
zTUWP/HEExb7PcCWLVtmcT7iVm0vMiaQN86PssyaNcvie+65R5L017/+ta7H868JPyKUj6r623ds
3brVYv8+7a/9VuWTERwAAJAcChwAAJCc0MqhvxBCR48z+olXvtWR7x0gSVdddZWk6vs8+Lvrrly5
0uIifs5ZlvU+lttCnZLD3rYfl6S3vOUtFvvJkn7IdsuWLZLaM+ydeg79NeR/vvXsjeFbVCtWrLDY
30Ijf+y3ve1tdsznu5m5TSWHftL2woULLR4wYECvX5+3qL70pS/ZMb+fir+9Si2LPvL30OOPP96O
ffSjH7X4gx/8oMWf+cxnLF6+fHldz9ObVHK41+NZPHv2bIuvvPJKiydOnCipciJwLfx7rL8FUd52
8u3h6dOnW5xP6ZCkZ5991uIZM2ZY3Oi+ObXkkBEcAACQHAocAACQHFpUNejq6rL4F7/4hSTppJNO
smN+q2s/JFf0ltUpDqs2yrdCfLvw85//vMX+9gt+VVw7V2SQw775lVF//vOfLfarfvJhcH+Lllbt
gxNzDv1+UH6l05AhQ3r9ev8elt+24bTTTrNj9a5E9G2U/Dn9Hiq+FeL5VT9+vzK/h0497aqYc1iN
/9n5dq3Peb6ird5VVP7WRP7xtm/fLkk66qij7Fi+UkuSxo0bZ7HPff45KlWulPR7x/WFFhUAACgl
ChwAAJCcjt3or5M8+eSTFt93332SKjeOmzBhgsWddCfVlPmtyPPtwqXKNoVf1dHMtlTeImt0RQcq
jR071mI/7O5vrZG3prg9Q30mT55ssV9ZWE3egpCkSZMmSerfBpm+nfyb3/xGUvW2lOdXtZ511lkW
33777Rb7672MfHt+xIgRFvvPpGqbKvbGT7fwemtv+ZWPb3jDGyyuttr4ne98p8V+1dV1111X8/nV
ghEcAACQHAocAACQHFpUNfB3pf7Yxz4mqXKzK7/SA83jh9T9Hd79sKafze+HrxGPb3zjGxb7DcS4
c3j/Pfjggxb79oFvr77wwgsWz5s3z+J6VrhU4zeg8/f+64tvP40ePdrielouKfKt+iuuuKLX4z7+
wx/+IEkaP358r//uN6r90Ic+ZPEXvvAFi3u79nbt2mVxtY0iq5334sWL+/z6RjGCAwAAkkOBAwAA
kkOLqgo/C339+vUW56txbr755pafU1nlM/Q//elP27E3vvGNFvtc+aHPr3zlKxZ/9rOfLfSc/PB+
OzcOTIVvNfhhct+uevzxx1t5SsnwrV3/uvWb5PlNFP1Gbv59Ls9Rva933za++uqra/4+3za77bbb
LP7JT35icX9WdKXAr5D6xCc+YbFv+/hra/jw4ZIqVwb/8Ic/tNi3rlavXm3xSy+9tN/z8G1D38Ly
z71582aLfT7XrVu338fuD0ZwAABAcihwAABAckrfovJDaJdcconF1TYcylcSvPjii809sZIbNGiQ
xXlr6tJLL7VjfqjdD9P6eNiwYRb71lWjmzH6x3j/+99v8ZIlS/Z53N27dzf0HGV14403Wux/dv5+
SWiMX4HkX6OPPPKIxf5nvmLFCovPPPNMi/P7ufnWVrVraeLEiRbff//9jZy2rr/+eosvv/xyi3nv
7d0dd9xh8Xe/+12LP/e5z1mcf9751Ym+dfSd73zHYn/t9bWJqZ/GsWzZMov9CuPLLrvM4nrvhdUo
RnAAAEBykrmbuP+N3o/K5LGvQP223/l24VLlHcKr7a/wvve9T9Ke39pbKcU74Pq8+cmQfjJiPhIz
cuRIO7Z06VKL/dbtjz76qMXf//73LX744YctbvQ178/P36oj/03nmWee6fMxUsxho/zE1oceeshi
P2n82GOPtXjnzp2tObE+pJLDgw7aM4D/qU99yuKvfvWrFv/0pz+1+Pe//72kymvPj+YcdthhFvt8
dnV11XxOc+bMsfjLX/6yxUV/TqWSw1r499h8ArkfsfN72NQr3/PGvx9u2LDBYr+nUjtyyAgOAABI
DgUOAABITjKTjH0Lqq/tu/1W0r7VdPLJJ/f5PHfddVcDZwfPD2UPGTLEYj9xd8uWLRbnk+fWrl3b
62P49pPfK+Xpp59u6Pz8PiCDBw+2eM2aNRbfc889Fl911VWSKlufGzdubOi5y+Siiy6y2N+52E9A
ZEJp8/g2hd/vZtGiRRb7hRc///nPJVVesz7O/12qrS2Vv2d/8YtftGPf+973LGZ/qWL4z8Yiriff
2sz3OPKTiTtpbyJGcAAAQHIocAAAQHKSaVF5vQ1t+j1M/MzuWrbw91tPcxfjxviZ/L695O+A61s8
vjWU35bBbz/u72x87rnnWuy/ZubMmRb7rcZ/8IMfSKpcFeXvGO/3a5g8ebLFfmjWr7g777zzJHH7
jlpMmTLF4ry1J1Xmwm8d39f+GyiG389m27ZtFvuViHkufPv43e9+t8X1tKUk6YwzzpBUuZIVnclP
6/Dvffnn4fbt21t+TrVgBAcAACSHAgcAACQnyRaVl6+o6u7utmP+rqu+LVKN3+ocjfEtwosvvtji
qVOnWnzEEUf0+r35DP3jjjvOjvmZ+qeccorF73jHOyz2dzH2LrzwQkmVG/P52zr4dprnj/tN5264
4QZJldufo9I555wjSZo/f74d88PevvV75513WsxKmvbaunXrPsd8q/Yvf/mLxQ8++KDFEyZMsPjZ
Z5+1eNKkSRZzG454+E1W/fuqX8HaiRjBAQAAyaHAAQAAyUmyReU3+nvd614nSZo7d64dGzduXK9f
W41f+YHG+BaVv9Nwfn8bac+qCqmyZZFv9Oc3JvPtDX9XZN+KXL16tcX5Sidpzz2QfFvKr+7wsV9R
Mnv2bIv9/Xh27NghqbbXUpn4HE2fPn2fY/7n5dvAK1eubMHZoVH+OvQba1577bUW+/sR+evJ37ka
8fBtKb/itJb777UTIzgAACA5FDgAACA5Sbao/Cz/Cy64QJI0fvz4uh7j3nvvtfi3v/1tMSdWYr4F
4VdO+ZbFwQcfbLHfeKy3e5v41TW+/eVj/zr49re/vc9j+LbVqlWrLPYtL78ppP9/8OeXr65iU7pK
vpXx5JNPSqpcfebvFebbk510Lxvsn78O/Humvw537dplMddIPHwL+U1vepPFCxYssLjT88kIDgAA
SA4FDgAASE5o5UZaIYSmPZkfThs0aJDF119/vSTp/PPPt2N+WM1/n5/h71da+Y2q2inLsrYv02lm
DsuAHO7hN07s9KFujxzGjxzWx08f8C3Hdqolh4zgAACA5CQzglPN2LFjJUljxoyxY36PlT/96U8W
r1u3rnUn1gB+64gfOYwfOYwfOYwfIzgAAKCUKHAAAEBykm9RpYRh1fiRw/iRw/iRw/jRogIAAKVE
gQMAAJJDgQMAAJJDgQMAAJJDgQMAAJLT6ruJ75C0ocXPmYrj2n0CPchh48hh/Mhh/Mhh/GrKYUuX
iQMAALQCLSoAAJAcChwAAJAcChwAAJAcChwAAJAcChwAAJAcChwAAJAcChwAAJAcChwAAJAcChwA
AJCc/wd2BEmBJkPz5QAAAABJRU5ErkJggg==
">
</div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        " linebreaks: { automatic: true, width: '95% container' }, " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>

    </main>

<footer class="footer">
  <div class="container">
    <span class="text-muted">Copyright 2018 &copy;
      <a class="text-muted" href="https://iacs.seas.harvard.edu/">Institute for Applied Computational Science</a>
    </span>
  </div>
</footer>

    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
  </body>
</html>